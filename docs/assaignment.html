<!DOCTYPE html>
<head>
    <meta charset="utf-8" />
    <!-- Set the viewport width to device width for mobile -->
    <meta name="viewport" content="width=device-width" />

    <title>Assaignment</title>

    <link rel="stylesheet" href="https://kk23mm14.github.io/pynotes-kranti/theme/css/normalize.css" />
    <link rel="stylesheet" href="https://kk23mm14.github.io/pynotes-kranti/theme/css/foundation.min.css" />
    <link rel="stylesheet" href="https://kk23mm14.github.io/pynotes-kranti/theme/css/style.css" />
    <link rel="stylesheet" href="https://kk23mm14.github.io/pynotes-kranti/theme/css/pygments.css" />	
    <script src="https://kk23mm14.github.io/pynotes-kranti/theme/js/modernizr.js"></script>
</head>

<body>

<!-- Nav Bar -->
<nav>
<div class="top-bar">
<div class="row">
    <div class="large-9 large-centered columns">
	    <h1><a href="https://kk23mm14.github.io/pynotes-kranti">my python notes</a></h1>
    </div>
</div>
</div>

<!-- Show menu items and pages -->
<div class="row">
<div class="large-9 columns">
    <ul class="button-group navigation">

    </ul>
</div>
</div>
</nav>
<!-- End Nav -->


<!-- Main Page Content and Sidebar -->
<div class="row">

    <!-- Main Blog Content -->
    <div class="large-9 columns">
<article>
    <header>
        <h3 class="article-title"><a href="https://kk23mm14.github.io/pynotes-kranti/assaignment.html" rel="bookmark"
        title="Permalink to Assaignment">Assaignment</a></h3>
    </header>

<h6 class="subheader" title="2025-08-05T00:00:00-04:00">Tue 05 August 2025
</h6>


    <div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">load_wine</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">StandardScaler</span><span class="p">,</span> <span class="n">LabelEncoder</span>
<span class="kn">from</span> <span class="nn">sklearn.impute</span> <span class="kn">import</span> <span class="n">SimpleImputer</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span> <span class="nn">sklearn.decomposition</span> <span class="kn">import</span> <span class="n">PCA</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="n">data</span> <span class="o">=</span> <span class="n">load_wine</span><span class="p">()</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">feature_names</span><span class="p">)</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">target</span>
<span class="n">df_cleaned</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">--- Dataset Info ---&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">info</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">--- Summary Stats ---&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">describe</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">--- Class Distribution ---&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">())</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="gd">--- Dataset Info ---</span>
&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 178 entries, 0 to 177
Data columns (total 14 columns):
<span class="w"> </span>#   Column                        Non-Null Count  Dtype  
<span class="gd">---  ------                        --------------  -----  </span>
<span class="w"> </span>0   alcohol                       178 non-null    float64
<span class="w"> </span>1   malic_acid                    178 non-null    float64
<span class="w"> </span>2   ash                           178 non-null    float64
<span class="w"> </span>3   alcalinity_of_ash             178 non-null    float64
<span class="w"> </span>4   magnesium                     178 non-null    float64
<span class="w"> </span>5   total_phenols                 178 non-null    float64
<span class="w"> </span>6   flavanoids                    178 non-null    float64
<span class="w"> </span>7   nonflavanoid_phenols          178 non-null    float64
<span class="w"> </span>8   proanthocyanins               178 non-null    float64
<span class="w"> </span>9   color_intensity               178 non-null    float64
<span class="w"> </span>10  hue                           178 non-null    float64
<span class="w"> </span>11  od280/od315_of_diluted_wines  178 non-null    float64
<span class="w"> </span>12  proline                       178 non-null    float64
<span class="w"> </span>13  target                        178 non-null    int64  
dtypes: float64(13), int64(1)
memory usage: 19.6 KB
None

<span class="gd">--- Summary Stats ---</span>
<span class="w"> </span>         alcohol  malic_acid         ash  alcalinity_of_ash   magnesium  \
count  178.000000  178.000000  178.000000         178.000000  178.000000   
mean    13.000618    2.336348    2.366517          19.494944   99.741573   
std      0.811827    1.117146    0.274344           3.339564   14.282484   
min     11.030000    0.740000    1.360000          10.600000   70.000000   
25%     12.362500    1.602500    2.210000          17.200000   88.000000   
50%     13.050000    1.865000    2.360000          19.500000   98.000000   
75%     13.677500    3.082500    2.557500          21.500000  107.000000   
max     14.830000    5.800000    3.230000          30.000000  162.000000

<span class="w"> </span>      total_phenols  flavanoids  nonflavanoid_phenols  proanthocyanins  \
count     178.000000  178.000000            178.000000       178.000000   
mean        2.295112    2.029270              0.361854         1.590899   
std         0.625851    0.998859              0.124453         0.572359   
min         0.980000    0.340000              0.130000         0.410000   
25%         1.742500    1.205000              0.270000         1.250000   
50%         2.355000    2.135000              0.340000         1.555000   
75%         2.800000    2.875000              0.437500         1.950000   
max         3.880000    5.080000              0.660000         3.580000

<span class="w"> </span>      color_intensity         hue  od280/od315_of_diluted_wines      proline  \
count       178.000000  178.000000                    178.000000   178.000000   
mean          5.058090    0.957449                      2.611685   746.893258   
std           2.318286    0.228572                      0.709990   314.907474   
min           1.280000    0.480000                      1.270000   278.000000   
25%           3.220000    0.782500                      1.937500   500.500000   
50%           4.690000    0.965000                      2.780000   673.500000   
75%           6.200000    1.120000                      3.170000   985.000000   
max          13.000000    1.710000                      4.000000  1680.000000

<span class="w"> </span>          target  
count  178.000000  
mean     0.938202  
std      0.775035  
min      0.000000  
25%      0.000000  
50%      1.000000  
75%      2.000000  
max      2.000000

<span class="gd">--- Class Distribution ---</span>
target
1    71
0    59
2    48
Name: count, dtype: int64
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;bmi&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
<span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">10</span><span class="p">:</span><span class="mi">12</span><span class="p">,</span> <span class="s1">&#39;bp&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;🔹 Missing values before filling:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">df</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="err">🔹</span><span class="w"> </span><span class="nx">Missing</span><span class="w"> </span><span class="nx">values</span><span class="w"> </span><span class="nx">before</span><span class="w"> </span><span class="nx">filling</span><span class="p">:</span>
<span class="w"> </span><span class="nx">alcohol</span><span class="w">                           </span><span class="mi">0</span>
<span class="nx">malic_acid</span><span class="w">                        </span><span class="mi">0</span>
<span class="nx">ash</span><span class="w">                               </span><span class="mi">0</span>
<span class="nx">alcalinity_of_ash</span><span class="w">                 </span><span class="mi">0</span>
<span class="nx">magnesium</span><span class="w">                         </span><span class="mi">0</span>
<span class="nx">total_phenols</span><span class="w">                     </span><span class="mi">0</span>
<span class="nx">flavanoids</span><span class="w">                        </span><span class="mi">0</span>
<span class="nx">nonflavanoid_phenols</span><span class="w">              </span><span class="mi">0</span>
<span class="nx">proanthocyanins</span><span class="w">                   </span><span class="mi">0</span>
<span class="nx">color_intensity</span><span class="w">                   </span><span class="mi">0</span>
<span class="nx">hue</span><span class="w">                               </span><span class="mi">0</span>
<span class="nx">od280</span><span class="o">/</span><span class="nx">od315_of_diluted_wines</span><span class="w">      </span><span class="mi">0</span>
<span class="nx">proline</span><span class="w">                           </span><span class="mi">0</span>
<span class="nx">target</span><span class="w">                            </span><span class="mi">0</span>
<span class="nx">bmi</span><span class="w">                             </span><span class="mi">178</span>
<span class="nx">bp</span><span class="w">                              </span><span class="mi">178</span>
<span class="nx">dtype</span><span class="p">:</span><span class="w"> </span><span class="nx">int64</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
    <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">frac</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">--- Missing After Injection ---&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="gd">--- Missing After Injection ---</span>
alcohol                           9
malic_acid                        9
ash                               9
alcalinity_of_ash                 9
magnesium                         9
total_phenols                     9
flavanoids                        9
nonflavanoid_phenols              9
proanthocyanins                   9
color_intensity                   9
hue                               9
od280/od315_of_diluted_wines      9
proline                           9
target                            9
bmi                             178
bp                              178
dtype: int64
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">sklearn.impute</span> <span class="kn">import</span> <span class="n">SimpleImputer</span>
<span class="n">df_cleaned</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">features</span> <span class="o">=</span> <span class="n">df_cleaned</span><span class="o">.</span><span class="n">columns</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">imputer</span> <span class="o">=</span> <span class="n">SimpleImputer</span><span class="p">(</span><span class="n">strategy</span><span class="o">=</span><span class="s1">&#39;mean&#39;</span><span class="p">)</span>
<span class="n">df_cleaned</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">features</span><span class="p">]</span> <span class="o">=</span> <span class="n">imputer</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">df_cleaned</span><span class="p">[</span><span class="n">features</span><span class="p">])</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="n">df_cleaned</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">features</span> <span class="o">=</span> <span class="n">df_cleaned</span><span class="o">.</span><span class="n">columns</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>  
<span class="n">imputer</span> <span class="o">=</span> <span class="n">SimpleImputer</span><span class="p">(</span><span class="n">strategy</span><span class="o">=</span><span class="s1">&#39;mean&#39;</span><span class="p">)</span>
<span class="n">df_cleaned</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">features</span><span class="p">]</span> <span class="o">=</span> <span class="n">imputer</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">df_cleaned</span><span class="p">[</span><span class="n">features</span><span class="p">])</span>
<span class="n">scaler</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span>
<span class="n">df_cleaned</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">features</span><span class="p">]</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">df_cleaned</span><span class="p">[</span><span class="n">features</span><span class="p">])</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">matshow</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">corr</span><span class="p">(),</span> <span class="n">fignum</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">)),</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">90</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">)),</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Correlation Matrix&quot;</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>

<p><img alt="png" src="/pynotes-kranti/images/assaignment_7_0.png"></p>
<div class="highlight"><pre><span></span><code><span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
    <span class="k">if</span> <span class="n">pd</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">types</span><span class="o">.</span><span class="n">is_numeric_dtype</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">])</span> <span class="ow">and</span> <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">notna</span><span class="p">()</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">(),</span> <span class="n">bins</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Histogram of </span><span class="si">{</span><span class="n">col</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="n">col</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Frequency&quot;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Skipping column: </span><span class="si">{</span><span class="n">col</span><span class="si">}</span><span class="s2"> (non-numeric or all NaN)&quot;</span><span class="p">)</span>
</code></pre></div>

<p><img alt="png" src="/pynotes-kranti/images/assaignment_8_0.png"></p>
<p><img alt="png" src="/pynotes-kranti/images/assaignment_8_1.png"></p>
<p><img alt="png" src="/pynotes-kranti/images/assaignment_8_2.png"></p>
<p><img alt="png" src="/pynotes-kranti/images/assaignment_8_3.png"></p>
<p><img alt="png" src="/pynotes-kranti/images/assaignment_8_4.png"></p>
<p><img alt="png" src="/pynotes-kranti/images/assaignment_8_5.png"></p>
<p><img alt="png" src="/pynotes-kranti/images/assaignment_8_6.png"></p>
<p><img alt="png" src="/pynotes-kranti/images/assaignment_8_7.png"></p>
<p><img alt="png" src="/pynotes-kranti/images/assaignment_8_8.png"></p>
<p><img alt="png" src="/pynotes-kranti/images/assaignment_8_9.png"></p>
<p><img alt="png" src="/pynotes-kranti/images/assaignment_8_10.png"></p>
<p><img alt="png" src="/pynotes-kranti/images/assaignment_8_11.png"></p>
<p><img alt="png" src="/pynotes-kranti/images/assaignment_8_12.png"></p>
<p><img alt="png" src="/pynotes-kranti/images/assaignment_8_13.png"></p>
<div class="highlight"><pre><span></span><code>Skipping column: bmi (non-numeric or all NaN)
</code></pre></div>

<div class="highlight"><pre><span></span><code>
</code></pre></div>

<hr>
<p><strong>Score: 10</strong></p>
<p class="subheader">Category: <a href="https://kk23mm14.github.io/pynotes-kranti/category/kranti.html">kranti</a>

</p>




</article>
    </div>
    <!-- End Main Content -->

    <!-- Sidebar -->
    <aside class="large-3 columns">
        <h5 class="sidebar-title">Site</h5>
        <ul class="side-nav">
            <li><a href="https://kk23mm14.github.io/pynotes-kranti/archives.html">Archives</a>
            <li><a href="https://kk23mm14.github.io/pynotes-kranti/tags.html">Tags</a>
        </ul>

		
        <h5 class="sidebar-title">Categories</h5>
        <ul class="side-nav">
            <li><a href="https://kk23mm14.github.io/pynotes-kranti/category/basics.html">basics</a></li>
            <li><a href="https://kk23mm14.github.io/pynotes-kranti/category/kranti.html">kranti</a></li>
            <li><a href="https://kk23mm14.github.io/pynotes-kranti/category/pandas-work.html">pandas-work</a></li>
   
        </ul>

		
        <h5 class="sidebar-title">Social</h5>
        <ul class="side-nav">
            <li><a href="https://github.com/kk23mm14/">GitHub</a></li>
            <li><a href="<linkedin handle>">LinkedIn</a></li>
        </ul>

    </aside> <!-- End Sidebar -->

</div> <!-- End Main Content and Sidebar -->


<!-- Footer -->
<footer class="row">
    <div class="large-12 columns">
        <hr />
        <div class="row">
            <div class="large-6 columns">
              <!--                  <p>my python notes by <kranti></p> -->
            </div>
            </div>
    </div>
</footer>
</body>
</html>